!function(t,i){"use strict";"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?module.exports=i():t.Pixelart=i()}(this,function(){"use strict";function t(t,i,o){return this._ensureDefined(["target",t],["ascii",i]),this.ascii=i,this.target=t.jquery?t[0]:t,this.options=o,this._cleanOptions(),this.draw(),this}function i(t,i,o,e,n){return function(){t.fillStyle=i,t.fillRect(o,e,n,n)}}function o(t){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),o=i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null;if(!o)throw new Error("Invalid color: "+t);return o}function e(t){return"rgb("+t.r+", "+t.g+", "+t.b+")"}return t.prototype._ensureDefined=function(){Array.prototype.slice.call(arguments).forEach(function(t){if(void 0===t[1])throw new Error("required argument "+t[0])})},t.prototype._cleanOptions=function(){this.options||(this.options={}),this.options={pixelSize:this.options.pixelSize||10,color:this.options.color?o(this.options.color):{r:0,g:0,b:0},colorMap:this.options.colorMap?this._buildColorMap(this.options.colorMap):null,stagger:this.options.stagger||0}},t.prototype._buildColorMap=function(t){var i={};return Object.keys(t).forEach(function(e){i[e]=o(t[e])}),i},t.prototype.cols=function(){var t=0;return this._iterateRows(function(i){i.length>t&&(t=i.length)}),t},t.prototype.rows=function(){return this.ascii.length},t.prototype.width=function(){return this.cols()*this.options.pixelSize},t.prototype.height=function(){return this.rows()*this.options.pixelSize},t.prototype._createCanvas=function(){var t=document.createElement("canvas");return t.width=this.width(),t.height=this.height(),t},t.prototype._iterateRows=function(t){var i=this;this.ascii.forEach(function(o,e){t.apply(i,[o,e])})},t.prototype._iterate=function(t){var i=this;this._iterateRows(function(o,e){this.ascii[e].split("").forEach(function(o,n){t.apply(i,[o,n,e])})})},t.prototype.color=function(){return this.options.color},t.prototype.draw=function(){for(;this.target.firstChild;)this.target.removeChild(this.target.firstChild);var t,o=this._createCanvas(),n=o.getContext("2d"),r=0;return this._iterate(function(o,s,p){" "!==o&&(t=e(this.options.colorMap&&o in this.options.colorMap?this.options.colorMap[o]:this.options.color),this.options.stagger&&0!==r?setTimeout(i(n,t,s*this.options.pixelSize,p*this.options.pixelSize,this.options.pixelSize),this.options.stagger*r):(n.fillStyle=t,n.fillRect(s*this.options.pixelSize,p*this.options.pixelSize,this.options.pixelSize,this.options.pixelSize)),++r)}),this.target.appendChild(o),this},t.prototype.destroy=function(){this.target.removeChild(this.target.firstElementChild)},t});