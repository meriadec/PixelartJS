!function(t,i){"use strict";"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?module.exports=i():t.Pixelart=i()}(this,function(){"use strict";function t(t,i,e){return h(["target",t],["ascii",i]),this.target=t.jquery?t[0]:t,this.options=r(e),s(i)?(this.multiple=!0,this.frames=i,this.ascii=i[0]):this.ascii=i,this.draw(),this}function i(t,i,e,o,r){return function(){t.fillStyle=i,t.fillRect(e,o,r,r)}}function e(t){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),e=i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null;if(!e)throw new Error("Invalid color: "+t);return e}function o(t){return"rgb("+t.r+", "+t.g+", "+t.b+")"}function r(t){return t||(t={}),{pixelSize:t.pixelSize||10,color:t.color?e(t.color):{r:0,g:0,b:0},colorMap:t.colorMap?n(t.colorMap):null,stagger:t.stagger||0,speed:t.speed||1e3,loop:!!t.loop}}function s(t){if("[object Array]"!==Object.prototype.toString.call(t))throw new Error("ascii arguments needs an Array, instead got a "+typeof t);return t[0]&&"string"!=typeof t[0]}function n(t){var i={};return Object.keys(t).forEach(function(o){i[o]=e(t[o])}),i}function h(){Array.prototype.slice.call(arguments).forEach(function(t){if(void 0===t[1])throw new Error("required argument "+t[0])})}function a(t,i,e){t.forEach(function(t,o){i.apply(e||this,[t,o])})}function p(t,i,e){a(t,function(o,r){t[r].split("").forEach(function(t,o){i.apply(e||this,[t,o,r])})})}function l(t,i,e,o,r,s){return function(){o&&i.clearRect(0,0,r,s),t._drawAscii(i,e)}}return t.prototype.cols=function(){function t(t){t.length>i&&(i=t.length)}var i=0;if(this.multiple)for(var e=0;e<this.frames.length;e++)a(this.frames[e],t);else a(this.ascii,t);return i},t.prototype.rows=function(){if(this.multiple){for(var t=0,i=0;i<this.frames.length;i++)this.frames[i].length>t&&(t=this.frames[i].length);return t}return this.ascii.length},t.prototype.width=function(){return this.cols()*this.options.pixelSize},t.prototype.height=function(){return this.rows()*this.options.pixelSize},t.prototype._createCanvas=function(){var t=document.createElement("canvas");return t.width=this.width(),t.height=this.height(),t},t.prototype.color=function(){return this.options.color},t.prototype.draw=function(){for(var t=this;this.target.firstChild;)this.target.removeChild(this.target.firstChild);var i=this._createCanvas(),e=i.getContext("2d");if(this.target.appendChild(i),this.multiple){for(var o=this.width(),r=this.height(),s=0;s<this.frames.length;s++){var n=(this.options.speed+this.options.stagger)*s;setTimeout(l(t,e,t.frames[s],s>0,o,r),n)}this.options.loop&&setTimeout(function(){t.draw.apply(t)},(this.options.speed+this.options.stagger)*this.frames.length)}else this._drawAscii(e,this.ascii);return this},t.prototype._drawAscii=function(t,e){var r,s=0;p(e,function(e,n,h){" "!==e&&(r=o(this.options.colorMap&&e in this.options.colorMap?this.options.colorMap[e]:this.options.color),this.options.stagger&&0!==s?setTimeout(i(t,r,n*this.options.pixelSize,h*this.options.pixelSize,this.options.pixelSize),this.options.stagger*s):(t.fillStyle=r,t.fillRect(n*this.options.pixelSize,h*this.options.pixelSize,this.options.pixelSize,this.options.pixelSize)),++s)},this)},t.prototype.destroy=function(){this.target.removeChild(this.target.firstElementChild)},t});